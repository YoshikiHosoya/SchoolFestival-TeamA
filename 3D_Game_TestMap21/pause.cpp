// =====================================================================================================================================================================
//
// ポーズの処理 [pause.cpp]
// Author : Sato Yoshiki
//
// =====================================================================================================================================================================
#include "pause.h"			// インクルードファイル
#include "pauseUI.h"
#include "keyboard.h"
#include "renderer.h"
//#include "sound.h"
#include "scene.h"
#include "xinputGpad.h"

// =====================================================================================================================================================================
// 静的メンバ変数の初期化
// =====================================================================================================================================================================
int					CPause::m_nNum = 0;

// =====================================================================================================================================================================
// マクロ定義
// =====================================================================================================================================================================
#define MAX_NUM		(1)

// =====================================================================================================================================================================
//
// コンストラクタ
//
// =====================================================================================================================================================================
CPause::CPause()
{
}

// =====================================================================================================================================================================
//
// デストラクタ
//
// =====================================================================================================================================================================
CPause::~CPause()
{

}

// =====================================================================================================================================================================
//
// 初期化処理
//
// =====================================================================================================================================================================
HRESULT CPause::Init()
{
	// 止めるフラグ初期化
	m_bStop = false;

	// ポーズUIの画像のロード
	CPauseUI::Load();

	// ポーズUIの生成
	CPauseUI::Create();

	// 初期化
	return S_OK;
}

// =====================================================================================================================================================================
//
// 終了処理
//
// =====================================================================================================================================================================
void CPause::Uninit(void)
{
	// 全ての開放
	CScene::ReleaseAll();
}

// =====================================================================================================================================================================
//
// 更新処理
//
// =====================================================================================================================================================================
void CPause::Update(void)
{
	// 変数
	CKeyboard	*pKeyboard		= CManager::GetKeyboard();
	CXinputGpad *pXinputGpad	= CManager::GetXinputGpad();

	// ポーズボタンを押したとき
	if (pKeyboard->GetKeyboardTrigger(DIK_P) || pXinputGpad->GetTriggerXinputGpad(CXinputGpad::XINPUT_START))
	{
		// フラグ切替え
		if (m_bStop)
		{
			m_bStop = false;
		}
		else 
		{
			m_bStop = true;
		}

		// ポーズで止める設定
		CScene::SetPauseStop(m_bStop);
	}

	// アイコンの移動
	IconMove(pKeyboard);
}

// =====================================================================================================================================================================
//
// 描画処理
//
// =====================================================================================================================================================================
void CPause::Draw(void)
{	
}

// =====================================================================================================================================================================
//
// ポーズの生成
//
// =====================================================================================================================================================================
CPause * CPause::Create()
{
	// 変数
	CPause *pPause;

	// メモリの確保
	pPause = new CPause;

	// 初期化
	pPause->Init();

	return pPause;
}

// =====================================================================================================================================================================
//
// アイコンの移動移動
//
// =====================================================================================================================================================================
void CPause::IconMove(CKeyboard *pKeyboard)
{
	// === アイコン移動 ===
	if (pKeyboard->GetKeyboardTrigger(DIK_UP))
	{
		// デクリメント
		m_nNum--;

		// 最後に戻す
		if (m_nNum < 0)
		{
			m_nNum = MAX_NUM;
		}
	}
	if (pKeyboard->GetKeyboardTrigger(DIK_DOWN))
	{
		// インクリメント
		m_nNum++;

		// 最初に戻す
		if (m_nNum > MAX_NUM)
		{
			m_nNum = 0;
		}
	}
	//// ナンバーの設定
	//CTitleUI::SetNum(m_nNum);
}