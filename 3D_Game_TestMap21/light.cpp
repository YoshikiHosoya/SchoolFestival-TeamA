// =====================================================================================================================================================================
//
// ライト処理 [light.cpp]
// Author : Sato Yoshiki
//
// =====================================================================================================================================================================
#include "light.h"						// インクルードファイル
#include "renderer.h"
#include "manager.h"

// =====================================================================================================================================================================
// マクロ定義
// =====================================================================================================================================================================
#define MAX_LIGHT		(3)						// ライトの数

// =====================================================================================================================================================================
// グローバル変数
// =====================================================================================================================================================================

// =====================================================================================================================================================================
//
// コンストラクタ
//
// =====================================================================================================================================================================
CLight::CLight()
{
}

// =====================================================================================================================================================================
//
// デストラクタ
//
// =====================================================================================================================================================================
CLight::~CLight()
{
}

// =====================================================================================================================================================================
//
// 初期化処理
//
// =====================================================================================================================================================================
void CLight::Init()
{	
	
	LPDIRECT3DDEVICE9 pDevice = *CManager::GetRenderer()->GetDevice();	// デバイスの取得
	D3DXVECTOR3 vecDir[MAX_LIGHT];										// 設定用方向ベクトル

	// ライトの設定
	for (int nCntLight = 0; nCntLight < MAX_LIGHT; nCntLight++)
	{
		// ライトをクリアする
		ZeroMemory(&m_aLight[nCntLight], sizeof(D3DLIGHT9));

		// ライトの種類を設定
		m_aLight[nCntLight].Type = D3DLIGHT_DIRECTIONAL;

		// ライトの拡散光を設定
		m_aLight[nCntLight].Diffuse = m_aLightCol[nCntLight];

		// ライトの方向の設定
		vecDir[nCntLight] = m_aLightDir[nCntLight];

		// 正規化する
		D3DXVec3Normalize(&vecDir[nCntLight], &vecDir[nCntLight]);

		m_aLight[nCntLight].Direction = vecDir[nCntLight];

		// ライトをレンダリングパイプラインに設定する
		pDevice->SetLight(nCntLight, &m_aLight[nCntLight]);

		// ライトを有効にする
		pDevice->LightEnable(nCntLight, TRUE);
	}
}

// =====================================================================================================================================================================
//
// 終了処理
//
// =====================================================================================================================================================================
void CLight::Uninit()
{
}

// =====================================================================================================================================================================
//
// 更新処理
//
// =====================================================================================================================================================================
void CLight::Update()
{
}